\documentclass[12pt]{article}
\input{Config/packages.tex}
\input{Config/borders.tex}
\input{Config/commands.tex}

\begin{document}

\definecolor{comment}{rgb}{0.71, 0.29, 0.29}

\input{Templates/title.tex}

\tableofcontents
\addtocontents{toc}{~\hfill\par}
\vfill ~
\setcounter{section}{0}

\section{Введение}

\indent{\indent Потребность в сельскохозяйственных продуктах увеличивается с каждым днем, как и растет население планеты Земля. Часть работ выполняют люди, и силы уходят на контроль качества выращиваемых культур. Мы сможем использовать временные и природные ресурсы более бережно и экономно, увеличим урожаи, если научимся дифференцировать благородные культуры и отличать их от сорняков без помощи человека. }

\indent{ В такой ситуации естественным образом приходит мысль об автоматизации процессов, например, классификация саженцев по фотоснимкам. Возникает мысль задействовать нейросети, что обосновано преимуществами, но также они обладают недостатками в виде вычислительных затрат. }

\indent{  Возможно использовать алгоритмы другой группы, но они требуют более тонкой настройки для достижения сопоставимого результата, а иногда вовсе не могут быть улучшены. В данной работе поставим задачу классификации растений и решим ее методом опорных векторов. }

\section{Анализ набора данных}
\subsection{Первичный взгляд на данные}

\indent{\indentИсследуемый набор данных был собран группой Орхусского университета по обработке сигналов в сотрудничестве в Университетом Южной Дании. Этапы создания коллекции описаны с статье \cite{bib_1}. Набор содержит приблизительно 960 уникальных изображений растений 12 видов, находящихся на разных стадиях роста. }\\
\indent{Изучимы исходные данные. Построим образцы каждого класса в виде сетки}

\begin{figure}[h]
	\centering
	\includegraphics[width=16.cm, height=12.cm]{first_view_grid_1}
	\caption{Образцы растений каждого вида (построчно)}
	\label{fig_1}
\end{figure}

\indent{ Проанализировав снимки, можно сделать некоторые выводы:}
\begin{itemize}
	\item {Исходные изображения уже кадрированы и не требуют дополнительной обрезки 
	\begin{figure}[h!]
		\centering
		\includegraphics[width=15.cm, height=5.cm]{first_view_three_1}
		\caption{Примеры исходных изображений}
		\label{fig_2}
	\end{figure}
	}
	\item Разрешения изображений варьируются от 50х50px до 2000х2000px, поэтому необходимо привести весь набор к единому разрешению. 
	\item Фон на снимках различен, необходимо выбрать спосбоб сегментации, наиболее подходящий для большинства
\end{itemize}

\indent{Заметим, что все представленные растения окрашены в зеленый цвет. Поэтому мы можем создать маску, фильтрующую диапазон зеленых оттенков и удаляющую пиксели остальных цветов. Для реализации воспользуемся библиотекой компьютерного зрения OpenCV \cite{bib_2} и библиотекой для вычислений Numpy \cite{bib_3} языка программирования Python.}

\subsection{Загрузка изображений}

\indent{\indent Библиотека OpenCV использует цветовую модель BGR (Blue Green Red) для представления цветных изображений. Каждый пиксель характеризуется составляющими синей, зеленой и красной компонентами. Загрузив изображение, изменим его разрешение до 200х200px. \textcolor{comment}{Нужно ли описывать способ интерполяции при ресайзе?}}

\subsection{Маскирование}

\indent{\indent Воспользуемся цветовой моделью HSV (Hue Saturation Value) \ref{fig_3}. В формате BGR значение каждой компоненты зависит от количества света, попадающего на объект. HSV же позволяет разграничить информацию о цвете и яркости. Оттенок, насыщенность и интенсивность позволяют задать нижнюю и верхнюю границы оттенков некоторого цвета, в данном случае –– зеленого.}

\begin{figure}[h]
	\centering
	\includegraphics[width=9.cm, height=7.cm]{hsv}
	\caption{Цветовая модель HSV}
	\label{fig_3}
\end{figure}

\indent{Получив цветовую маску, можем применить операцию логического умножения к исходному изображению, присвоить значениям пикселей фона значение черного цвета и получить сегментированное растение}

\threeimage{seg_step_1}{seg_step_2}{seg_step_3}{Исходное изображение}{Маска}{Сегментированное изображение}

\subsection{Удаление шума}

\indent{\indent Сегментация не всегда происходит хорошо, как на примере \ref{fig_f_ seg_step_3}. Небольшие участки фона могут попадать в диапазон зеленых значений, что вызывает искажение бинарной маски, и получается эффект, представленный на рисунке ниже}

\begin{figure}[h]
	\centering
	\includegraphics[width=7.cm, height=7.cm]{seg_no_morph_1}
	\caption{Искажения при сегментации}
	\label{fig_4}
\end{figure}

\indent{Такие недостатки можно устранить при помощи морфологических операций –– нелинейных преобразованиях,  связанных с формой и структурой некоторого объекта, в данном случае, изображения. При обработке изображений морфология используется для исследования взаимодействия изображения с определенным структурирующим элементом –– ядром –– с помощью морфологических операций. Ядро итерируется по всему изображению и сравнивается с окрестностью пикселей, что описано в источнике \cite{bib_4}. }

\indent{ Для улучшения сегментации применим операцию морфологического закрытия –– комбинацию операций дилатации и эрозии.}

\indent{ Эрозия бинарного изображения $f$ ядром $s$ (обозначается $f \ominus s$) производит новое бинарное изображение $g = f \ominus s$ с единицами на всех позициях $(x, y)$ ядра, где оно полностью совпадает с исходным изображением $f$, то есть $g(x, y) = 1$, если $s$ поэлементно совпадает с участком $f$ и $0$ в другом случае, для всех координат пикселей $(x, y)$}

\begin{figure}[h]
	\centering
	\includegraphics[width=12.cm, height=5.cm]{mor-pri-erosion}
	\caption{Эрозия с ядром 3х3}
	\label{fig_5}
\end{figure}

\indent{ Дилатация бинарного изображения $f$ ядром $s$ (обозначается $f \oplus s$) производит новое бинарное изображение $g = f \oplus s$ с единицами на всех позициях $(x, y)$ ядра, где оно совпадает с исходным изображением $f$ хотя бы в одной позиции, то есть $g(x, y) = 1$, если $s$ совпадает хотя бы в одной позиции с участком $f$ и $0$ в другом случае, для всех координат пикселей $(x, y)$}

\begin{figure}[h]
	\centering
	\includegraphics[width=12.cm, height=5.cm]{mor-pri-dilation}
	\caption{Дилатация с ядром 3х3}
	\label{fig_6}
\end{figure}

\indent{\textcolor{comment}{Нужны ли ссылки на изображения \ref{fig_5} и \ref{fig_6}? }}

\indent{ Теперь можем определить операцию закрытия изображения $f$ ядром $s$ как $f \bullet s = (f \oplus s) \ominus s$. Струкрутрный элемент может быть любой формы, и его выбор зависит от формы недостатков, которые требуется устранить.}

\indent{ Применим операцию закрытия к изображению \ref{fig_4}, выбрав эллиптическое ядро размером 6x6px и удалим оставшиеся объекты площадью менее 160px}

\begin{figure}[h]
	\centering
	\includegraphics[width=7.cm, height=7.cm]{seg_morph_1}
	\caption{Изображение после закрытия маски}
	\label{fig_7}
\end{figure}

\indent{ Растение на изображении \ref{fig_7} не имеет полостей, а фон очищен от не относящихся к растению элементов, что говорит о достигнутом результате.}

\begin{figure}[h]
	\centering
	\includegraphics[width=16.cm, height=12.cm]{segmented_part_1}
	\caption{Образцы растений каждого вида после сегментации (построчно)}
	\label{fig_8}
\end{figure}

\section{Извлечение признаков}

\section{Классификатор}

\section{Результаты исследований}

\newpage

\begin{thebibliography}{}
	\bibitem{bib_1} Giselsson, T., Jørgensen, R., Jensen, P., Dyrmann, M., and Midtiby, H. (2017). A Public Image Database for Benchmark of Plant Seedling Classification Algorithms. 
	\bibitem{bib_2} Bradski, G. (2000). The OpenCV Library. Dr. Dobb's Journal of Software Tools.
	\bibitem{bib_3} Oliphant, T. E. (2006). A guide to NumPy (Vol. 1). Trelgol Publishing USA.
	\bibitem{bib_4} Panja, D., Poppe, R. (2018). INFOIBV. Image Processing course, Universiteit Utrecht.
\end{thebibliography}

\end{document}{}